<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title class="pageTitle">Loading...</title>
    <meta name="description" content="Loading app information..." />
    <meta property="og:title" content="NotchNest" />
    <meta property="og:description" content="Loading app information..." />
    <meta property="og:url" content="https://notchnest.github.io" />
    <meta property="og:site_name" content="NotchNest" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="NotchNest" />
    <meta name="twitter:description" content="Loading app information..." />
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon" sizes="16x16" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#000000" />
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="notchnest-body">
    <!-- Subtle background animation -->
    <div class="background-gradient"></div>

    <!-- Rain animation background -->
    <figure
        class="rain pix pointer-events-none fixed inset-0 z-10 m-0 h-dvh w-dvw -scale-x-[1] bg-repeat opacity-10 mix-blend-overlay">
    </figure>

    <main class="main-container">
        <div class="content-wrapper">
            <!-- Hero Section -->
            <section class="hero-section">
                <div class="app-showcase">
                    <div class="app-icon-wrapper">
                        <div class="loading-skeleton app-icon-placeholder">
                            <div class="icon-shimmer"></div>
                        </div>
                        <img alt="App icon" loading="lazy" width="120" height="120" decoding="async"
                            class="app-icon appIconLarge headerIcon" src="" style="display: none;" />
                    </div>
                    <div class="app-info">
                        <div class="app-header">
                            <h1 class="app-title">
                                <span class="appName headerName loading-text">Loading...</span>
                                <code class="version-badge" style="display: none;">v1.0.0</code>
                            </h1>
                            <p class="app-description appDescription loading-text">
                                Loading app information...
                            </p>
                        </div>
                        <div class="download-section">
                            <a target="_blank" class="download-btn appStoreLink loading-skeleton" href="#"
                                style="pointer-events: none;">
                                <img src="assets/download-appstore.svg" alt="Download on App Store"
                                    class="download-icon" />
                            </a>
                            <a target="_blank" rel="noreferrer" class="product-hunt-btn"
                                href="https://www.producthunt.com/">
                                <svg class="ph-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                    fill="none" viewBox="0 0 11 16">
                                    <path fill="currentColor"
                                        d="M6.541 5.422a.418.418 0 0 1 0-.583l1.8-1.849a.402.402 0 0 1 .286-.121.393.393 0 0 1 .284.121l1.8 1.849a.418.418 0 0 1 0 .583l-1.8 1.848a.402.402 0 0 1-.284.121.393.393 0 0 1-.285-.12l-1.8-1.85ZM5.545 4.4l-1.8-1.847a.413.413 0 0 1-.119-.292.421.421 0 0 1 .119-.293l1.8-1.847A.402.402 0 0 1 5.83 0a.393.393 0 0 1 .284.12l1.802 1.848a.413.413 0 0 1 .118.293.422.422 0 0 1-.118.292L6.114 4.4a.402.402 0 0 1-.284.12.393.393 0 0 1-.285-.12Zm0 1.46a.402.402 0 0 1 .285-.121.393.393 0 0 1 .284.121l1.802 1.847A.414.414 0 0 1 8.034 8a.422.422 0 0 1-.118.292L6.114 10.14a.402.402 0 0 1-.284.12.393.393 0 0 1-.285-.12l-1.8-1.847a.413.413 0 0 1-.119-.292.421.421 0 0 1 .119-.292l1.8-1.849ZM2.75 7.27l-1.8-1.848A.413.413 0 0 1 .83 5.13a.422.422 0 0 1 .118-.292l1.8-1.848a.402.402 0 0 1 .285-.12.393.393 0 0 1 .285.12l1.8 1.848a.42.42 0 0 1 0 .584l-1.8 1.848a.402.402 0 0 1-.285.121.393.393 0 0 1-.284-.12ZM8.91 8.73l1.8 1.848a.415.415 0 0 1 .088.45.415.415 0 0 1-.087.133l-1.8 1.848a.403.403 0 0 1-.285.121.395.395 0 0 1-.284-.12L6.54 11.16a.42.42 0 0 1 0-.583L8.343 8.73a.397.397 0 0 1 .568 0ZM6.114 11.6l1.801 1.848a.412.412 0 0 1 .119.292.422.422 0 0 1-.119.292l-1.8 1.848a.402.402 0 0 1-.285.12.393.393 0 0 1-.285-.12l-1.8-1.848a.413.413 0 0 1-.119-.292.422.422 0 0 1 .119-.292l1.8-1.848a.403.403 0 0 1 .285-.121.395.395 0 0 1 .284.121Zm-.995-1.021a.418.418 0 0 1 0 .583L3.318 13.01a.398.398 0 0 1-.57 0l-1.8-1.848a.418.418 0 0 1 0-.584l1.8-1.848a.402.402 0 0 1 .285-.12.393.393 0 0 1 .285.12l1.8 1.848Z">
                                    </path>
                                </svg>
                                View on Product Hunt
                            </a>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Video Demo Section -->
            <section class="demo-section">
                <div class="demo-card">
                    <video width="640" autoplay muted loop playsinline class="demo-video">
                        <source src="assets/notchnest-demo.mp4" type="video/mp4" />
                        Your browser does not support the video tag.
                    </video>
                    <div class="demo-info">
                        <p class="system-requirement">
                            Minimum OS requirement:
                            <code class="os-badge minimumOsVersion loading-text">Loading...</code>
                        </p>
                    </div>
                </div>
            </section>

            <!-- Features Section -->
            <section class="features-section">
                <div class="feature-card">
                    <div class="feature-image-container">
                        <img alt="Settings on how to use the app" width="300" height="300" class="settings-image"
                            src="assets/notchnest-settings.png" />
                    </div>
                    <div class="feature-content">
                        <h2 class="feature-title">Powerful & Intuitive</h2>
                        <div class="feature-description">
                            <p>NotchNest seamlessly integrates with your Mac's notch area, providing quick access to
                                essential functions without interrupting your workflow.</p>
                            <ul class="feature-list">
                                <li>âœ¨ Clean, minimal interface design</li>
                                <li>âš¡ Lightning-fast performance</li>
                                <li>ðŸ”§ Extensive customization options</li>
                                <li>ðŸŽ¯ Intuitive gesture controls</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FAQ Section -->
            <section id="faq-section" class="faq-section">
                <h2 class="section-title">Frequently Asked Questions</h2>
                <div class="faq-grid">
                    <div class="faq-card">
                        <h3 class="faq-question">
                            What about <span class="appName loading-text">the app</span>'s privacy policy?
                        </h3>
                        <p class="faq-answer">
                            Sure! <a class="faq-link" href="privacy-policy.html">Check it out here</a>
                        </p>
                    </div>

                    <div class="faq-card">
                        <h3 class="faq-question">What about notchless screens?</h3>
                        <p class="faq-answer">
                            It turns into a nice handler with the exact same functions
                        </p>
                    </div>

                    <div class="faq-card">
                        <h3 class="faq-question">Does it support multiple monitors?</h3>
                        <p class="faq-answer">
                            Yes, it does
                        </p>
                    </div>

                    <div class="faq-card">
                        <h3 class="faq-question">How many devices cover my license?</h3>
                        <p class="faq-answer">
                            Available on all macOS devices linked to the Apple ID you used to purchase the app
                        </p>
                    </div>
                </div>
            </section>

            <!-- Footer -->
            <footer class="footer">
                <div class="footer-content">
                    <p class="footer-text">Send us a letter!</p>
                    <a href="mailto:29satnam@gmail.com" class="footer-link">
                        29satnam@gmail.com
                    </a>
                </div>
            </footer>
        </div>
    </main>

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <!-- App Store API Integration with Caching -->
    <script>
        // App ID constant for easy management
        const APP_ID = "6747612321";
        const CACHE_KEY = "notchnest_app_data";
        const CACHE_DURATION = 5 * 60 * 1000; // 5 minutes in milliseconds

        // Loading skeleton styles
        const loadingSkeletonCSS = `
            .loading-skeleton {
                background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
                background-size: 200% 100%;
                animation: loading-shimmer 2s infinite;
            }
            
            @keyframes loading-shimmer {
                0% { background-position: -200% 0; }
                100% { background-position: 200% 0; }
            }
            
            .loading-text {
                color: rgba(255, 255, 255, 0.5) !important;
            }
        `;

        // Add loading styles
        const styleSheet = document.createElement('style');
        styleSheet.textContent = loadingSkeletonCSS;
        document.head.appendChild(styleSheet);

        // Cache management functions
        function getCachedData() {
            try {
                const cached = localStorage.getItem(CACHE_KEY);
                if (cached) {
                    const data = JSON.parse(cached);
                    const now = new Date().getTime();
                    if (now - data.timestamp < CACHE_DURATION) {
                        console.info("Using cached app data");
                        return data.appInfo;
                    }
                }
            } catch (e) {
                console.warn("Error reading cache:", e);
            }
            return null;
        }

        function setCachedData(appInfo) {
            try {
                const cacheData = {
                    appInfo: appInfo,
                    timestamp: new Date().getTime()
                };
                localStorage.setItem(CACHE_KEY, JSON.stringify(cacheData));
                console.info("App data cached successfully");
            } catch (e) {
                console.warn("Error caching data:", e);
            }
        }

        // Update UI with app data
        function updateUI(appInfo) {
            // Remove loading states
            document.querySelectorAll('.loading-skeleton').forEach(el => {
                el.classList.remove('loading-skeleton');
            });

            document.querySelectorAll('.loading-text').forEach(el => {
                el.classList.remove('loading-text');
            });

            // Set favicon
            $('link[rel="shortcut icon"]').attr("href", appInfo.artworkUrl512);

            // Set page title
            document.title = appInfo.trackName + " - NotchNest";
            $('meta[property="og:title"]').attr("content", appInfo.trackName + " - NotchNest");
            $('meta[name="twitter:title"]').attr("content", appInfo.trackName + " - NotchNest");

            // Set app icon
            const $appIcon = $(".appIconLarge");
            $appIcon.attr("src", appInfo.artworkUrl512).show();
            $(".app-icon-placeholder").hide();

            // Set app name
            $(".appName").html(appInfo.trackCensoredName || appInfo.trackName);
            $(".headerName").html(appInfo.trackCensoredName || appInfo.trackName);

            // Set version info
            if (appInfo.version) {
                $(".version-badge").text("v" + appInfo.version).show();
            }

            // Set description (first line only)
            const firstLine = appInfo.description.split('.')[0] + '.';
            $(".appDescription").html(firstLine);

            // Set full description in dynamic content
            $(".dynamic-content").html('<p>' + appInfo.description + '</p>').show();

            // Set minimum OS version
            $(".minimumOsVersion").html("macOS " + appInfo.minimumOsVersion);

            // Set App Store links
            $(".appStoreLink").attr("href", appInfo.trackViewUrl).css("pointer-events", "auto");
            $(".download-icon").css("opacity", "1");

            // Update meta descriptions
            $('meta[name="description"]').attr("content", firstLine);
            $('meta[property="og:description"]').attr("content", firstLine);
            $('meta[name="twitter:description"]').attr("content", firstLine);

            console.info("UI updated with app data:", appInfo);
        }

        // Show placeholder when no data is available
        function showPlaceholder() {
            // Keep loading states but with placeholder content
            $(".appName").html("NotchNest");
            $(".headerName").html("NotchNest");
            $(".appDescription").html("A powerful utility for your Mac's notch area");
            $(".dynamic-content").html('<p>App information will be loaded when available.</p>');
            $(".minimumOsVersion").html("macOS 12.0+");

            // Show placeholder icon
            $(".app-icon-placeholder").css({
                'background': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                'display': 'flex',
                'align-items': 'center',
                'justify-content': 'center',
                'color': 'white',
                'font-weight': 'bold',
                'font-size': '36px'
            }).text('N');

            console.info("Showing placeholder content");
        }

        // Handle anchor scrolling
        function handleAnchorScroll() {
            if (window.location.hash) {
                const targetId = window.location.hash.substring(1);
                const targetElement = document.getElementById(targetId);
                if (targetElement) {
                    setTimeout(() => {
                        // Check if smooth scrolling is supported
                        if ('scrollBehavior' in document.documentElement.style) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        } else {
                            // Fallback for older browsers
                            const elementTop = targetElement.offsetTop - 100; // Account for any fixed headers
                            window.scrollTo(0, elementTop);
                        }
                    }, 500); // Small delay to ensure content is loaded
                }
            }
        }

        // Main initialization function
        $(function () {
            // Try to load from cache first
            const cachedData = getCachedData();
            if (cachedData) {
                updateUI(cachedData);
                handleAnchorScroll();
                return;
            }

            // Fetch from API if no cache
            const apiURL = "https://itunes.apple.com/lookup?id=" + APP_ID + "&callback=?";

            $.getJSON(apiURL, function (json) {
                if (json.results && json.results.length) {
                    const appInfo = json.results[0];

                    // Cache the data
                    setCachedData(appInfo);

                    // Update UI
                    updateUI(appInfo);
                    handleAnchorScroll();
                } else {
                    console.error("No app data found");
                    showPlaceholder();
                    handleAnchorScroll();
                }
            }).fail(function () {
                console.error("Failed to fetch app data from iTunes API");
                showPlaceholder();
                handleAnchorScroll();
            });
        });
    </script>

    <script src="script.js"></script>
</body>

</html>